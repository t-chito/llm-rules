# issue 対応ルール

## ユーザーとのコミュニケーション

1. issue 対応はユーザーとのペアプロのようなものだと思ってください。自分の判断に自信がない場合、無理に結論を出すのではなく、ユーザーへ尋ねるように心がけてください。
2. issue 対応において、あなたはユーザーに対し以下の責任を持ちます。
    - 作業内容のトレーサビリティを担保すること。
    - 作業内容についての説明責任を果たすこと。
    そのため、あなたの作業履歴や作業の意図をユーザーにテキストに書き出して伝えることは非常に重要です。
3. タスクを始めるにあたって、少なくとも、ユーザーは Notion Issue の URL を伝えているはずです。
    URL を読み取ったら、まずは `Issue ID` を使って `ai/ISSUE-3570` のような作業用のディレクトリを作成してください。ユーザーに情報を伝えるときは、このディレクトリ以下を使ってください。

## issue 対応の進め方

### 1. コンテキストの理解

ユーザーから伝えた情報と、自身で調査した情報を合わせて、今回のタスクについての理解を深めてください。
この作業での入出力は以下のようなイメージです。

- inputs
    - Issue や Epic の URL
    - 既存の実装
    - その他ユーザーから提示された情報
- outputs
    - references.md : 参照した URL や ファイルパス のリスト
    - spec.md : 現在の実装を仕様として書き下したドキュメント
    - context.md : 今回の issue に関して理解したこと、実装に影響しそうだが理解できなかったこと
    - plans.md : 概念的な実装計画 (commit 粒度で計画を立ててください)
    - README.md : ざっくりとした概要

内容が整理できたら、以下のことを行ってください。

1. spec/context/plans が矛盾していないことをセルフチェックする
2. plans が commit 粒度の計画になっていることをセルフチェックする
3. 内容に自身がない箇所を (辻褄を合わせるためではなく、ユーザーに指示を仰ぐために) 整理し、plans に改めて追記する
4. 実装、あるいはユーザーへの相談に進むにあたって、十分な整理ができていることをセルフチェックする

ここまでが完了したら、ユーザーに報告してください。ユーザー側で内容をレビューして、必要に応じて修正します。

### 2. 具体的な実装作業

コンテキスト理解のステップで整理した内容をもとに、実際に作業を進めてください。

- inputs
    - 「コンテキストの理解」ステップで整理したドキュメント
- outputs
    - log.md : 簡単な作業内容、途中で考えたこと、追加の調査内容など、PR の意図をトレースできるような簡易的なメモ。
    - コード自体の修正

以下は作業にあたっての注意点です。

- 作業は plans をもとに、commit の粒度でユーザーとやり取りをしてください
- log.md は、実装メモとして適宜書き込むようにしてください
- 自信がない場合、作業の意図や方針が明確でない場合などは、ユーザーに質問をして充分に理解をしてから行ってください
- 区切りごとに、ユーザーに作業内容を報告し、フィードバックを求めてください

