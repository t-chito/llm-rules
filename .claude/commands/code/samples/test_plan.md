# 割引システムテスト計画

## 要件理解

### 対象機能

商品購入時の割引金額計算システム

### 主要なビジネスルール

- 会員ランク別の基本割引率（一般 5%、シルバー 10%、ゴールド 15%、プラチナ 20%）
- 購入金額に応じた段階的割引（5 万円以上で追加 3%、10 万円以上で追加 5%）
- 期間限定キャンペーン割引（特定期間中は全商品 10%OFF）
- 複数割引の組み合わせ制限と優先順位
- 端数処理（1 円未満切り捨て）
- 特殊ケース（無料商品、割引対象外商品）

## テスト対象となる機能/振る舞いの一覧

### 1. 会員ランク別割引

**検証すべき観点：**

- 正常系：各ランクの基本割引率が正しく適用される
- 境界値：ランク変更直後の割引率適用
- 特殊ケース：未登録ユーザー、無効なランク

**想定テストケース数：** 6 件

### 2. 購入金額別段階割引

**検証すべき観点：**

- 正常系：各金額帯での追加割引率適用
- 境界値：49,999 円、50,000 円、99,999 円、100,000 円
- エラー系：負の金額、0 円

**想定テストケース数：** 8 件

### 3. 期間限定キャンペーン割引

**検証すべき観点：**

- 正常系：キャンペーン期間中の割引適用
- 境界値：キャンペーン開始直前・直後、終了直前・直後
- 特殊ケース：複数キャンペーンの重複

**想定テストケース数：** 7 件

### 4. 複数割引の組み合わせ制限 ★ 詳細設計対象

**検証すべき観点：**

- 正常系：許可される組み合わせパターン
- 制限系：排他的な割引の組み合わせ
- 優先順位：複数適用可能時の優先順位ルール
- 境界値：最大割引率の上限チェック

**想定テストケース数：** 12 件

### 5. 端数処理

**検証すべき観点：**

- 正常系：1 円未満切り捨ての動作
- 境界値：0.4 円、0.5 円、0.9 円での処理
- 特殊ケース：割引後金額が 0 円以下になる場合

**想定テストケース数：** 5 件

### 6. 特殊ケース

**検証すべき観点：**

- 無料商品への割引適用
- 割引対象外商品の除外
- システムエラー時の動作

**想定テストケース数：** 4 件

## 総想定テストケース数

42 件（各機能の重要度に応じて調整可能）

## 実装優先度

1. **高**：複数割引の組み合わせ制限（ビジネスロジックの中核）
2. **高**：購入金額別段階割引（計算ロジックの複雑さ）
3. **中**：会員ランク別割引（基本機能）
4. **中**：期間限定キャンペーン割引（時間依存ロジック）
5. **低**：端数処理（補助的機能）
6. **低**：特殊ケース（エラーハンドリング）
